<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Farcaster FID Checker</title>

  <!-- MINI APP IDENTIFIER -->
  <meta name="fc:miniapp" content='{
    "homeURL": "https://fidchecker.pages.dev/",
    "icon": "https://fidchecker.pages.dev/assets/icon-192.png"
  }' />

  <!-- OG TAGS FOR PREVIEW -->
  <meta property="og:title" content="Farcaster FID Checker" />
  <meta property="og:description" content="Automatically displays your Farcaster FID and profile photo." />
  <meta property="og:image" content="https://fidchecker.pages.dev/assets/icon-192.png" />
  <meta property="og:image:width" content="600" />
  <meta property="og:image:height" content="600" />

  <!-- TWITTER CARD -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Farcaster FID Checker" />
  <meta name="twitter:description" content="Instant Farcaster identity viewer." />
  <meta name="twitter:image" content="https://fidchecker.pages.dev/assets/icon-192.png" />

  <!-- STYLE -->
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #6F42C1;
      font-family: "Inter", sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: white;
    }

    .card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      width: 90%;
      max-width: 420px;
      padding: 30px;
      text-align: center;
      box-shadow: 0 20px 40px rgba(0,0,0,0.25);
    }

    .avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      margin: 15px auto;
      border: 4px solid rgba(255,255,255,0.5);
    }

    .fid-box {
      margin-top: 20px;
      display: flex;
      justify-content: center;
      gap: 10px;
      align-items: center;
    }

    .copy-btn {
      background: white;
      color: #6F42C1;
      padding: 8px 18px;
      border-radius: 10px;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }

    .loading {
      opacity: 0.7;
      margin-top: 10px;
    }
  </style>

</head>

<body>
  <div class="card">
    <h2>Farcaster FID Checker</h2>
    <p style="opacity: 0.8;">Automatically shows your Farcaster identity</p>

    <img id="avatar" class="avatar" src="https://fidchecker.pages.dev/assets/default-avatar.png" alt="avatar" />

    <div class="fid-box">
      <span id="fid" style="font-size: 20px;">...</span>
      <button class="copy-btn" onclick="copyFID()">Copy</button>
    </div>

    <p id="status" class="loading">Detecting your Farcaster profile...</p>
  </div>

  <script>
    async function loadViewer() {
      try {
        const res = await fetch("https://api.warpcast.com/v2/viewer", { credentials: "include" });
        const data = await res.json();

        if (!data.result || !data.result.viewer) {
          document.getElementById("status").innerText = "Please open from Farcaster.";
          return;
        }

        const user = data.result.viewer;
        const fid = user.fid;
        const pfp = user.profile?.pfp?.url || "https://fidchecker.pages.dev/assets/default-avatar.png";

        document.getElementById("avatar").src = pfp;
        document.getElementById("fid").innerText = fid;
        document.getElementById("status").innerText = "Profile loaded";
      } catch (e) {
        document.getElementById("status").innerText = "Unable to fetch viewer.";
      }
    }

    function copyFID() {
      const fid = document.getElementById("fid").innerText;
      navigator.clipboard.writeText(fid);
      alert("FID copied!");
    }

    loadViewer();
  </script>
</body>
</html>
