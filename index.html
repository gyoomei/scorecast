<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ScoreCast — Check FID & Neynar Score</title>

  <!-- OpenGraph -->
  <meta property="og:title" content="ScoreCast — Check Your FID & Neynar Score" />
  <meta property="og:description" content="Instantly check your Farcaster identity stats — FID & Neynar score." />
  <meta property="og:image" content="https://scorecast-beryl.vercel.app/assets/icon-512.png" />
  <meta property="og:url" content="https://scorecast-beryl.vercel.app" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Farcaster hints -->
  <meta name="fc:frame" content="vNext" />
  <meta name="fc:frame:button:1" content="Open ScoreCast" />
  <meta name="fc:frame:button:1:action" content="link" />
  <meta name="fc:frame:button:1:target" content="https://scorecast-beryl.vercel.app" />

  <style>
    :root{
      --bg1: #6F47FF;
      --bg2: #8A63FF;
      --glass: rgba(255,255,255,0.10);
      --card: rgba(255,255,255,0.10);
      --muted: rgba(255,255,255,0.75);
      --accent: #ffffff;
      --radius: 16px;
      --maxw: 720px;
      --glass-2: rgba(255,255,255,0.06);
    }
    [data-theme="dark"]{
      --bg1:#1e0d3b;
      --bg2:#5a2df2;
      --glass: rgba(255,255,255,0.04);
      --card: rgba(255,255,255,0.03);
      --muted: rgba(255,255,255,0.8);
      --accent: #fff;
    }
    [data-theme="light"]{
      --bg1:#ffffff;
      --bg2:#f3f0ff;
      --glass: rgba(0,0,0,0.04);
      --card: rgba(0,0,0,0.03);
      --muted: rgba(17,24,39,0.8);
      --accent: #0f172a;
    }

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    body{
      display:flex;align-items:center;justify-content:center;
      background: linear-gradient(135deg,var(--bg1),var(--bg2));
      transition: background .4s ease;
      padding:28px;
      color:var(--accent);
    }

    .wrap{
      width:100%;max-width:var(--maxw);
      display:grid;grid-template-columns: 1fr 360px;gap:22px;
      align-items:start;
    }

    /* Left - main card */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border-radius: var(--radius);
      padding:22px;
      backdrop-filter: blur(8px) saturate(120%);
      box-shadow: 0 10px 30px rgba(0,0,0,0.18);
      border: 1px solid rgba(255,255,255,0.06);
      color:var(--accent);
      transition: transform .25s ease, box-shadow .25s ease;
    }
    .card:hover{ transform: translateY(-4px); box-shadow:0 18px 40px rgba(0,0,0,0.25); }

    .header{
      display:flex;align-items:center;gap:14px;
    }
    .logo{
      width:64px;height:64px;border-radius:14px;background:url('./assets/icon-128.png') center/cover no-repeat;border:1px solid rgba(255,255,255,0.06);
    }
    .title{ font-weight:700; font-size:20px; line-height:1; }
    .subtitle{ font-size:13px; color:var(--muted); margin-top:6px; }

    .profile{
      display:flex;gap:18px;align-items:center;margin-top:18px;
    }
    .avatar{
      width:96px;height:96px;border-radius:999px;object-fit:cover;border:4px solid rgba(255,255,255,0.9);box-shadow:0 8px 26px rgba(0,0,0,0.25);
      background:linear-gradient(180deg,rgba(255,255,255,0.06),transparent);
    }
    .meta{flex:1;text-align:left;}
    .name{font-weight:700;font-size:16px;}
    .fid{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Roboto Mono,monospace;font-size:13px;color:var(--muted); margin-top:6px; word-break:break-all;}

    .row-cards{ display:flex; gap:12px; margin-top:16px; flex-wrap:wrap; }
    .mini{
      background:var(--card); padding:12px 14px; border-radius:12px; min-width:140px; text-align:left;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
    }
    .score{ font-size:28px; font-weight:800; letter-spacing: -0.02em; }

    .actions{ display:flex; gap:10px; margin-top:16px; flex-wrap:wrap; }
    .btn{
      background: white; color: var(--bg1); border: none; padding:10px 14px; border-radius:10px; cursor:pointer; font-weight:600;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }
    .ghost{ background: transparent; border:1px solid rgba(255,255,255,0.08); color:var(--accent); }

    /* Right column - controls */
    .panel{
      background: var(--glass-2); border-radius:12px; padding:18px; min-height:160px; color:var(--accent);
      border:1px solid rgba(0,0,0,0.04);
      backdrop-filter: blur(6px);
    }
    label{ display:block; font-size:13px; margin-bottom:8px; color:var(--muted); }
    input[type="text"]{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(0,0,0,0.06); outline:none;
      font-family: monospace;
    }
    .small{ font-size:13px; color:var(--muted); margin-top:8px; }

    /* toggle */
    .toggle{
      display:flex; align-items:center; gap:10px; justify-content:space-between;
    }
    .switch{display:inline-flex;align-items:center}
    .switch input{display:none}
    .slider{
      width:46px;height:26px;border-radius:999px;background:linear-gradient(180deg,#ddd,#bbb);position:relative;padding:3px;cursor:pointer;
    }
    .knob{ width:20px;height:20px;border-radius:50%;background:white; transform:translateX(0); transition:transform .22s cubic-bezier(.2,.8,.2,1); }
    .on .knob{ transform:translateX(20px); }

    /* responsive */
    @media (max-width:880px){
      .wrap{ grid-template-columns: 1fr; }
      .panel{ order:-1; margin-bottom:10px; }
      .profile{ flex-direction:row; align-items:center; gap:12px; }
    }
  </style>
</head>
<body data-theme="">
  <div style="width:100%;max-width:1100px;">
    <div class="wrap">
      <main class="card" id="mainCard" role="main" aria-live="polite">
        <div class="header">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <div class="title">ScoreCast</div>
            <div class="subtitle">Instantly check your FID & Neynar score.</div>
          </div>
        </div>

        <section class="profile" style="margin-top:12px;">
          <img id="avatar" class="avatar" src="./assets/icon-128.png" alt="avatar" />
          <div class="meta">
            <div id="displayName" class="name">Preview User</div>
            <div id="fidText" class="fid">fid:1234567890</div>
            <div class="small" id="viewerHint">Opened in preview mode</div>
          </div>
        </section>

        <div class="row-cards" style="margin-top:18px;">
          <div class="mini">
            <div class="small">Neynar Score</div>
            <div id="neynarScore" class="score">42</div>
          </div>

          <div class="mini" style="flex:1;">
            <div class="small">Actions</div>
            <div style="margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;">
              <button class="btn" id="copyFidBtn">Salin FID</button>
              <button class="btn ghost" id="copyScoreBtn">Salin Skor</button>
              <button class="btn ghost" id="openAsMiniApp">Open as Mini App</button>
            </div>
          </div>
        </div>

        <div style="margin-top:18px;" class="small">
          Tip: Kamu bisa masukkan FID lain di panel kanan untuk cek cepat. Jika dibuka di Farcaster client, aplikasi akan mengambil profile asli.
        </div>
      </main>

      <aside class="panel" aria-label="Controls">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <div>
            <div style="font-weight:700">Controls</div>
            <div class="small">Interact & test</div>
          </div>
          <div class="toggle" style="width:170px;">
            <div style="font-size:13px;color:var(--muted)">Theme</div>
            <div class="switch" id="themeSwitch" role="switch" aria-checked="false" tabindex="0">
              <div class="slider" id="slider"><div class="knob"></div></div>
            </div>
          </div>
        </div>

        <hr style="border:none;height:12px">

        <label for="fidInput">Check another FID</label>
        <input id="fidInput" type="text" placeholder="masukkan fid:123..." autocomplete="off" />

        <div style="display:flex;gap:8px;margin-top:10px;">
          <button class="btn" id="checkBtn">Check</button>
          <button class="btn ghost" id="resetBtn">Reset to viewer</button>
        </div>

        <div class="small" style="margin-top:12px;">
          Pengambilan profil mencoba Farcaster SDK bila tersedia; jika tidak, gunakan mode preview atau masukkan FID manual.
        </div>
      </aside>
    </div>
  </div>

<script>
/*
  ScoreCast enhanced
  - tries Farcaster SDK to get viewer
  - deterministic Neynar fallback (0-100)
  - supports checking other FIDs via input
  - dark/light toggle persisted
*/

(function(){
  // utilities
  function computeNeynarFromString(s){
    if(!s) return 0;
    let h = 2166136261 >>> 0;
    for(let i=0;i<s.length;i++){
      h ^= s.charCodeAt(i);
      h = (h + ((h << 1) + (h << 4) + (h << 7) + (h << 8) + (h << 24))) >>> 0;
    }
    return Math.floor(h % 101);
  }

  function setText(id, text){ const el = document.getElementById(id); if(el) el.textContent = text; }

  function copyToClipboard(text, btn){
    if(!navigator.clipboard) { alert('Clipboard API not available'); return; }
    navigator.clipboard.writeText(text).then(()=>{
      const prev = btn.textContent;
      btn.textContent = 'Tersalin';
      setTimeout(()=> btn.textContent = prev, 1300);
    }).catch(()=> alert('Gagal salin'));
  }

  // theme
  const body = document.body;
  const switchWrap = document.getElementById('themeSwitch');
  const slider = document.getElementById('slider');

  function applyTheme(t){
    body.setAttribute('data-theme', t);
    if(t === 'light') slider.classList.add('on');
    else slider.classList.remove('on');
    localStorage.setItem('scorecast:theme', t);
    switchWrap.setAttribute('aria-checked', t === 'light');
  }
  // initial
  const saved = localStorage.getItem('scorecast:theme') || 'dark';
  applyTheme(saved);

  // toggle handlers
  switchWrap.addEventListener('click', ()=> applyTheme(body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'));
  switchWrap.addEventListener('keyup', (e)=> { if(e.key === 'Enter' || e.key === ' ') switchWrap.click(); });

  // UI elements
  const fidText = document.getElementById('fidText');
  const displayName = document.getElementById('displayName');
  const avatar = document.getElementById('avatar');
  const neynarScoreEl = document.getElementById('neynarScore');
  const viewerHint = document.getElementById('viewerHint');
  const fidInput = document.getElementById('fidInput');
  const checkBtn = document.getElementById('checkBtn');
  const resetBtn = document.getElementById('resetBtn');
  const copyFidBtn = document.getElementById('copyFidBtn');
  const copyScoreBtn = document.getElementById('copyScoreBtn');
  const openAsMiniApp = document.getElementById('openAsMiniApp');

  // state
  let current = { fid: 'fid:1234567890', name: 'Preview User', avatar: './assets/icon-128.png' };

  function renderCurrent(){
    fidText.textContent = current.fid;
    displayName.textContent = current.name || '—';
    avatar.src = current.avatar || './assets/icon-128.png';
    const score = computeNeynarFromString(String(current.fid));
    neynarScoreEl.textContent = score;
  }

  // try to detect farcaster SDK / viewer
  async function detectViewer(){
    try{
      const maybeSdk = (window.createMiniAppSdk && window.createMiniAppSdk()) ||
                       window.FarcasterMiniApp ||
                       window.farcasterMiniApp || null;

      if(!maybeSdk){ // fallback to query param if provided
        const params = new URLSearchParams(window.location.search);
        const qfid = params.get('fid');
        if(qfid){ current.fid = qfid; current.name = 'Remote FID'; current.avatar = './assets/icon-128.png'; }
        renderCurrent();
        viewerHint.textContent = 'Preview mode / SDK not available';
        return;
      }

      // tell host ready if supported
      if(maybeSdk.actions && typeof maybeSdk.actions.ready === 'function'){
        try { maybeSdk.actions.ready(); } catch(e){ /* ignore */ }
      }

      // get viewer/profile
      let viewer = null;
      if(maybeSdk.auth && typeof maybeSdk.auth.getViewer === 'function'){
        viewer = await maybeSdk.auth.getViewer();
      } else if(maybeSdk.auth && typeof maybeSdk.auth.requestAuth === 'function'){
        const session = await maybeSdk.auth.requestAuth();
        viewer = session?.viewer || session?.profile || session;
      }

      const profile = viewer?.profile || viewer || {};
      const fid = profile.fid || profile.id || profile.userId || String(profile?.address || current.fid);
      const name = profile.displayName || profile.name || profile.username || 'Farcaster user';
      const avatarUrl = profile.avatarUrl || profile.photo || profile.image || current.avatar;

      current = { fid: String(fid), name, avatar: avatarUrl };
      renderCurrent();
      viewerHint.textContent = 'Loaded from Farcaster SDK';
    }catch(err){
      console.warn('SDK detect failed', err);
      renderCurrent();
      viewerHint.textContent = 'Preview mode';
    }
  }

  // manual "Check another FID"
  async function checkFID(fid){
    if(!fid) { alert('Masukkan FID (contoh: fid:12345)'); return; }
    // Set temporarily the UI while trying to fetch real profile
    displayName.textContent = 'Loading...';
    fidText.textContent = fid;
    // Try external API (placeholder). If you have Neynar or other API, replace below.
    try{
      // Placeholder sample: try fetch profile (most APIs are restricted). We'll fallback to deterministic score anyway.
      // Example (commented): const resp = await fetch(`https://api.neynar.com/v2/farcaster/user?fid=${fid}`, {headers:{'api_key':'YOUR_KEY'}});
      // If you integrate a real API, parse and set profile fields.
      // For now, we just set fallback values:
      current.fid = fid;
      current.name = fid;
      current.avatar = './assets/icon-128.png';
      renderCurrent();
    }catch(e){
      console.warn('fetch failed', e);
      current.fid = fid;
      current.name = fid;
      current.avatar = './assets/icon-128.png';
      renderCurrent();
    }
  }

  // reset to viewer (detect again)
  resetBtn.addEventListener('click', ()=> detectViewer());

  // check button
  checkBtn.addEventListener('click', ()=> {
    const v = fidInput.value?.trim();
    if(!v) return;
    checkFID(v);
  });

  fidInput.addEventListener('keyup', (e)=> { if(e.key === 'Enter') checkBtn.click(); });

  // copy buttons
  copyFidBtn.addEventListener('click', ()=> copyToClipboard(current.fid, copyFidBtn));
  copyScoreBtn.addEventListener('click', ()=> copyToClipboard(neynarScoreEl.textContent, copyScoreBtn));

  openAsMiniApp.addEventListener('click', ()=> {
    // open as mini-app target
    window.open('https://scorecast-beryl.vercel.app','_blank');
  });

  // initial run
  detectViewer();
  // if no sdk, also render preview values
  setTimeout(()=> renderCurrent(), 200);

})();
</script>
</body>
</html>
1
